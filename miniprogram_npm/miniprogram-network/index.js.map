{"version":3,"sources":["index.js","cache.js","set-config.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA,AENA;ADIA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;ACFA,ADGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.upload = exports.download = exports.head = exports.patch = exports.del = exports.put = exports.post = exports.get = exports.request = void 0;\r\nvar miniprogram_downloader_1 = require(\"miniprogram-downloader\");\r\nvar miniprogram_request_1 = require(\"miniprogram-request\");\r\nvar miniprogram_uploader_1 = require(\"miniprogram-uploader\");\r\nvar miniprogram_request_2 = require(\"miniprogram-request\");\r\nObject.defineProperty(exports, \"Http\", { enumerable: true, get: function () { return miniprogram_request_2.Http; } });\r\nObject.defineProperty(exports, \"REQUEST\", { enumerable: true, get: function () { return miniprogram_request_2.REQUEST; } });\r\nObject.defineProperty(exports, \"transformRequestResponseOkData\", { enumerable: true, get: function () { return miniprogram_request_2.transformRequestResponseOkData; } });\r\nObject.defineProperty(exports, \"transformRequestSendDefault\", { enumerable: true, get: function () { return miniprogram_request_2.transformRequestSendDefault; } });\r\nObject.defineProperty(exports, \"CancelToken\", { enumerable: true, get: function () { return miniprogram_request_2.CancelToken; } });\r\nvar miniprogram_uploader_2 = require(\"miniprogram-uploader\");\r\nObject.defineProperty(exports, \"Uploader\", { enumerable: true, get: function () { return miniprogram_uploader_2.Uploader; } });\r\nObject.defineProperty(exports, \"UPLOAD\", { enumerable: true, get: function () { return miniprogram_uploader_2.UPLOAD; } });\r\nObject.defineProperty(exports, \"transformUploadResponseOkData\", { enumerable: true, get: function () { return miniprogram_uploader_2.transformUploadResponseOkData; } });\r\nObject.defineProperty(exports, \"transformUploadSendDefault\", { enumerable: true, get: function () { return miniprogram_uploader_2.transformUploadSendDefault; } });\r\nvar miniprogram_downloader_2 = require(\"miniprogram-downloader\");\r\nObject.defineProperty(exports, \"Downloader\", { enumerable: true, get: function () { return miniprogram_downloader_2.Downloader; } });\r\nObject.defineProperty(exports, \"DOWNLOAD\", { enumerable: true, get: function () { return miniprogram_downloader_2.DOWNLOAD; } });\r\nObject.defineProperty(exports, \"transformDownloadResponseOkData\", { enumerable: true, get: function () { return miniprogram_downloader_2.transformDownloadResponseOkData; } });\r\nObject.defineProperty(exports, \"transfomDownloadSendDefault\", { enumerable: true, get: function () { return miniprogram_downloader_2.transfomDownloadSendDefault; } });\r\nvar miniprogram_network_cache_1 = require(\"miniprogram-network-cache\");\r\nObject.defineProperty(exports, \"defaultKeyBuilder\", { enumerable: true, get: function () { return miniprogram_network_cache_1.defaultKeyBuilder; } });\r\nvar cache_1 = require(\"./cache\");\r\nObject.defineProperty(exports, \"cacheHttp\", { enumerable: true, get: function () { return cache_1.cacheHttp; } });\r\nObject.defineProperty(exports, \"cacheGet\", { enumerable: true, get: function () { return cache_1.get; } });\r\nObject.defineProperty(exports, \"cacheRequest\", { enumerable: true, get: function () { return cache_1.request; } });\r\nObject.defineProperty(exports, \"cacheDownload\", { enumerable: true, get: function () { return cache_1.download; } });\r\nObject.defineProperty(exports, \"cacheConfig\", { enumerable: true, get: function () { return cache_1.config; } });\r\nvar set_config_1 = require(\"./set-config\");\r\nObject.defineProperty(exports, \"setConfig\", { enumerable: true, get: function () { return set_config_1.setConfig; } });\r\nObject.defineProperty(exports, \"delayRetry\", { enumerable: true, get: function () { return set_config_1.delayRetry; } });\r\n// ShortLink for Request\r\n/**\r\n * REQUEST.request\r\n */\r\nexports.request = \r\n/*#__PURE__*/\r\nminiprogram_request_1.REQUEST.request.bind(miniprogram_request_1.REQUEST);\r\n/**\r\n * REQUEST.get\r\n */\r\n// tslint:disable-next-line: no-reserved-keywords\r\nexports.get = \r\n/*#__PURE__*/\r\nminiprogram_request_1.REQUEST.get.bind(miniprogram_request_1.REQUEST);\r\n/**\r\n * REQUEST.post\r\n */\r\nexports.post = \r\n/*#__PURE__*/\r\nminiprogram_request_1.REQUEST.post.bind(miniprogram_request_1.REQUEST);\r\n/**\r\n * REQUEST.put\r\n */\r\nexports.put = \r\n/*#__PURE__*/\r\nminiprogram_request_1.REQUEST.put.bind(miniprogram_request_1.REQUEST);\r\n/**\r\n * REQUEST.delete\r\n */\r\nexports.del = \r\n/*#__PURE__*/\r\nminiprogram_request_1.REQUEST.delete.bind(miniprogram_request_1.REQUEST);\r\n/**\r\n * REQUEST.patch\r\n */\r\nexports.patch = \r\n/*#__PURE__*/\r\nminiprogram_request_1.REQUEST.patch.bind(miniprogram_request_1.REQUEST);\r\n/**\r\n * REQUEST.head\r\n */\r\nexports.head = \r\n/*#__PURE__*/\r\nminiprogram_request_1.REQUEST.head.bind(miniprogram_request_1.REQUEST);\r\n// Short Link for Download\r\n/**\r\n * DOWNLOAD.download\r\n */\r\nexports.download = \r\n/*#__PURE__*/\r\nminiprogram_downloader_1.DOWNLOAD.download.bind(miniprogram_downloader_1.DOWNLOAD);\r\n// ShortLink for Upload\r\n/**\r\n * UPLOAD.upload\r\n */\r\nexports.upload = \r\n/*#__PURE__*/\r\nminiprogram_uploader_1.UPLOAD.upload.bind(miniprogram_uploader_1.UPLOAD);\r\n//# sourceMappingURL=index.js.map","\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.download = exports.get = exports.request = exports.cacheDownloader = exports.cacheHttp = exports.config = void 0;\r\nvar miniprogram_downloader_1 = require(\"miniprogram-downloader\");\r\nvar miniprogram_network_cache_1 = require(\"miniprogram-network-cache\");\r\nvar miniprogram_request_1 = require(\"miniprogram-request\");\r\n/** 缓存配置 */\r\nexports.config = {\r\n    /**\r\n     * 默认缓存时间\r\n     */\r\n    expire: 10 * 60 * 1000,\r\n    /**\r\n     * GET,HEAD,OPTIONS默认缓存\r\n     */\r\n    excludeMethod: ['POST', 'PUT', 'DELETE', 'TRACE', 'CONNECT'],\r\n    /**\r\n     * 结果判断条件\r\n     */\r\n    resultCondition: miniprogram_network_cache_1.isOkResult,\r\n    /**\r\n     * 缓存的键构建方式,\r\n     * 默认将不存在于`excludeMethod`采用`defaultKeyBuilder`进行构建(请求header不影响缓存)\r\n     * 修改后`excludeMethod`将失效\r\n     */\r\n    keyBuilder: function (param) { return ((exports.config.excludeMethod.indexOf(param.method) === -1) && miniprogram_network_cache_1.defaultKeyBuilder(param)); }\r\n};\r\n/**\r\n * 网络缓存\r\n */\r\nexports.cacheHttp = new miniprogram_request_1.Http(miniprogram_request_1.REQUEST.Defaults, \r\n/*#__PURE__*/\r\nminiprogram_network_cache_1.CacheOperator.createHandler(miniprogram_request_1.REQUEST.handle, exports.config), \r\n/*#__PURE__*/\r\nminiprogram_request_1.REQUEST.Listeners);\r\n/**\r\n * 下载缓存\r\n */\r\nexports.cacheDownloader = new miniprogram_downloader_1.Downloader(miniprogram_downloader_1.DOWNLOAD.Defaults, \r\n/*#__PURE__*/\r\nminiprogram_network_cache_1.CacheOperator.createHandler(miniprogram_downloader_1.DOWNLOAD.handle, exports.config), \r\n/*#__PURE__*/\r\nminiprogram_downloader_1.DOWNLOAD.Listeners);\r\n/**\r\n * request 缓存\r\n */\r\nexports.request = \r\n/*#__PURE__*/\r\nexports.cacheHttp.request.bind(exports.cacheHttp);\r\n/**\r\n * GET 缓存\r\n */\r\n// tslint:disable-next-line: no-reserved-keywords\r\nexports.get = \r\n/*#__PURE__*/\r\nexports.cacheHttp.get.bind(exports.cacheHttp);\r\n/**\r\n * 下载缓存\r\n */\r\nexports.download = \r\n/*#__PURE__*/\r\nexports.cacheDownloader.download.bind(exports.cacheDownloader);\r\n//# sourceMappingURL=cache.js.map","\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.delayRetry = exports.setConfig = void 0;\r\nvar miniprogram_downloader_1 = require(\"miniprogram-downloader\");\r\nvar miniprogram_request_1 = require(\"miniprogram-request\");\r\nvar miniprogram_uploader_1 = require(\"miniprogram-uploader\");\r\nfunction setConfig() {\r\n    if (arguments.length === 2) {\r\n        var key = arguments[0];\r\n        var value = arguments[1];\r\n        miniprogram_request_1.REQUEST.Defaults[key] = value;\r\n        miniprogram_downloader_1.DOWNLOAD.Defaults[key] = value;\r\n        miniprogram_uploader_1.UPLOAD.Defaults[key] = value;\r\n    }\r\n    else if (typeof arguments[0] === 'object') {\r\n        var config_1 = arguments[0];\r\n        Object.keys(config_1)\r\n            .forEach(function (key) {\r\n            miniprogram_request_1.REQUEST.Defaults[key] = config_1[key];\r\n            miniprogram_downloader_1.DOWNLOAD.Defaults[key] = config_1[key];\r\n            miniprogram_uploader_1.UPLOAD.Defaults[key] = config_1[key];\r\n        });\r\n    }\r\n}\r\nexports.setConfig = setConfig;\r\n/**\r\n * 延迟重试\r\n * 会在 options.__failure 记录失败的次数\r\n * @param delay 延时时间 单位ms\r\n * @param retryTimes 重试次数\r\n */\r\nfunction delayRetry(delay, retryTimes) {\r\n    if (retryTimes === void 0) { retryTimes = 1; }\r\n    return function (data, reason) {\r\n        var _this = this;\r\n        this.__failure = (this.__failure || 0) + 1;\r\n        return new Promise(function (resolve, reject) {\r\n            if (_this.__failure > retryTimes) {\r\n                reject(reason);\r\n            }\r\n            else {\r\n                setTimeout(resolve, delay, data); // tslint:disable-line: no-string-based-set-timeout\r\n            }\r\n        });\r\n    };\r\n}\r\nexports.delayRetry = delayRetry;\r\n//# sourceMappingURL=set-config.js.map"]}